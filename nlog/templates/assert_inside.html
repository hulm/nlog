{% extends "base.html" %}

{% block content %}
			
			  <div>
			      <p>
                      <button type="button" class="btn btn-success btn-sm">添加</button>
			          <button type="button" class="btn btn-danger btn-sm" id="deleteid">删除</button>
			          <button type="button" class="btn btn-danger btn-sm">修改</button>
			      </p>
			  </div>
                <div >
                  <input type="text">
                  <input type="submit" value="搜索" />
                </div>
                <div id="top_exa">
                </div>
				<table id="userlist" class="table table-bordered table-hover table-condensed">
					<thead>
                        <tr>
                            <th><input type="checkbox" id="checkall">全选</th>
                            <th>部门</th>
                            <th>编号</th>
                            <th>类型</th>
                            <th>型号</th>
                            <th>品牌</th>
                            <th>使用人</th>
                            <th>位置</th>
                            <th>删除</th>
                            <th>修改</th>
                            <th>保存</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in data %}
                        <tr>
                            <td><input type="checkbox" name="admincheckbox" /></th>
                            <td name="department">{{item.department}}</td>
                            <td name="number">{{item.number}}</td>
                            <td name="mach_type">{{item.type}}</td>
                            <td name="model">{{item.model}}</td>
                            <td name="brand">{{item.brand}}</td>
                            <td name="user">{{item.user}}</td>
                            <td name="position">{{item.position}}</td>
                            <td class="delete"><button type="button" class="btn btn-danger btn-sm">删除</button></td>
                            <td class="change"><button type="button" class="btn btn-warning btn-sm">修改</button></td>
                            <td class="save"><button type="button" class="btn btn-warning btn-sm">保存</button></td>
                            
                        </tr>
                        {% endfor %}
                    </tbody>
					
				</table>
                <div id="bottom_exa">
                </div>
				<script type="text/javascript">
				$(function(){
                    //删除方法
                    $('.delete button').click(function(){
                       number =  $(this).parent().parent().find("[name='number']").text();
                       if(confirm("确定要删除数据吗")){
                            $(this).parent().parent().remove();
                            $.ajax({
                            url:"/delete/",
                            type:'POST',
                            data:{'assert_number':number},
                            success:function(){
                                console.log("删除成功")
                            }
                            })
                        }
                       else{
                       }
                    })

                    //修改按钮方法
                       $('.change button').click(function(){
                        $(this).text("保存");
                       department =  $(this).parent().parent().find("[name='department']").text();
                       user =  $(this).parent().parent().find("[name='user']").text();
                       position =  $(this).parent().parent().find("[name='position']").text();
                        console.log(department);
                        $(this).parent().parent().find("[name='department']").replaceWith("<input type=\"text\" value="+department+" name=\"department\">");
                    })


                    //侧边栏添加样式
                    $('#management').addClass("in");
                    $('#assert_inside_management').addClass("active btn btn-default");

                    //分页功能
				    var options = {
                            alignment:"right",
                            currentPage: {{page}},
                            totalPages: {{pageCount}},
                            numberOfPages:10,
                            pageUrl: function(type, page, current){ 
                                return "http://localhost/assert_inside/"+page;
                                }  
                        }

                        $('#top_exa').bootstrapPaginator(options);
                        $('#bottom_exa').bootstrapPaginator(options);

                    })
				</script>
            
{% endblock %}
